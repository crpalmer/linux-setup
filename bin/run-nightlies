#!/bin/bash -i

UNOFFICIAL="
	device/samsung/mondrianlte
	device/samsung/picassolte
	device/samsung/tabpro-common
	vendor/samsung/tabpro-common
"

changelog-name() {
   echo /tmp/changelog-`echo $1 | sed 's@/@_@g'`.txt
}

generate-changelogs() {
echo $UNOFFICIAL
  for dir in $UNOFFICIAL
  do
echo $dir
changelog-name $dir
    generate-changelog $dir > `changelog-name $dir`
  done
}

push-changelogs() {
  for dir in $UNOFFICIAL
  do
    scp `changelog-name $dir` download.crpalmer.org:/nightlies/
  done
}

##########################################################################

(
  rm -rf /out/*

  start-cm-12.1

  sync-cm
  if [ "$?" != 0 ]; then
    echo "Problems syncing"
    exit 1
  fi

  (start-Z00A ; \
	repopick 103773; \
	repopick 101970 102426 102725 103343 103928 ; \
	cd $D ; \
	./extract-files.sh /data/zenfone2/firmware/current ; \
   start-cm Z008; \
	cd $D ; \
	./extract-files.sh /data/zenfone2/firmware/current-Z008 \
  )
  build-cm Z00A
  release-nightly Z00A
  build-cm Z008
  release-nightly Z008
  build-cm mondrianlte
  release-nightly mondrianlte
  build-cm picassolte
  release-nightly picassolte
) > /tmp/nightlies.txt 2>&1
